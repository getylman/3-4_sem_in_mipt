E. Вторая статистика (RMQ)

Ограничение времени	1 секунда
Ограничение памяти	64Mb
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt

Дано число N(2≤N≤105) и последовательность из N целых чисел, каждое не превосходит по модулю 10^9. Найти вторую порядковую статистику на заданных M диапазонах (1≤M≤10^5).
Для решения задачи используйте структуру данных Sparse Table (остальное не засчитывается). Требуемое время обработки каждого диапазона O(1). Время подготовки структуры данных O(NlogN).

Формат ввода
В первой строке заданы 2 числа: размер последовательности N и количество диапазонов M.
Следующие N целых чисел задают последовательность. Далее вводятся M пар чисел - границ диапазонов.
Формат вывода
Для каждого из M диапазонов напечатать элемент последовательности - 2ю порядковую статистику. По одному числу в строке.