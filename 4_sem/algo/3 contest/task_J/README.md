J*. Менеджмент инноватики 

Лаборатория инноватики ФПМИ работает с огромным числом компаний-партнеров. Ради удобства организации работы иерархия кафедр представляет из себя дерево. Есть изначальная компания с номером 1 — сама лаборатория. Вам предстоит написать программу, обрабатывающие события в жизни партнеров.

События могут быть одного из трех видов.

    + v — добавился новый партнер, его делают листом в дереве, а его предком стала компания с номером v. Добавившейся вершине нужно присвоить наименьший натуральный номер, который до этого еще никогда не встречался.
    - v — компания с номером v разорвала контракты с лабораторией, предком её детей становится её предок.
    ? u v — надо найти наименьшего общего предка компаний с номерами u и v. Зачем — тайна бизнеса.

Формат ввода
Во входном файле записано число q, обозначающее количество запросов (1≤q≤200000). Далее на отдельных строках следуют q в формате выше.

Изначально есть только лаборатория с номером 1, гарантируется, что она никогда не будет удалена.

Формат вывода
Для каждого запроса типа «?» в выходной файл нужно вывести на отдельной строке одно число — номер интересующей компании. 