I. Пятнашки c восстановлением ответа

Написать алгоритм для решения игры в “пятнашки”. Решением задачи является приведение к виду: [ 1 2 3 4 ] [ 5 6 7 8 ] [ 9 10 11 12] [ 13 14 15 0 ], где 0 задает пустую ячейку. Необходимо найти минимальное решение.

Обратите внимание на ограничения! Потренируйтесь на предыдущей задаче перед решением этой.

Формат ввода
Начальная расстановка.

Формат вывода
Если вам удалось найти решение, то в первой строке файла выведите число перемещений, которое требуется сделать в вашем решении. А во второй строке выведите соответствующую последовательность ходов: L означает, что в результате перемещения костяшка сдвинулась влево, R – вправо, U – вверх, D – вниз. Если же выигрышная конфигурация недостижима, то выведите в выходной файл одно число −1. 

Примечания 
Заметьте, что в отличие от предыдущей задачи в последовательности все ходы тут реверснутые. Вы спросите, почему? Вам ответят - этот вопрос на физтехе запрещен. 