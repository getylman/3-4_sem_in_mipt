F. Лекции от А.

Некий А. собирается выступить с лекциями по всему миру. Он знает, что постоянно нервничает при перелетах. На некоторых маршрутах он теряет вес от волнения, а на других — много ест и набирает вес.

Известно, что чем больше весит А., тем лучше он прочтет лекцию, поэтому требуется спланировать перелеты так, чтобы вес А. на каждой лекции был максимально возможным. Он должен посещать города в том же порядке, в котором он читает свои лекции. При этом между лекциями он может посещать промежуточные города.

Формат ввода
Первая строка входного файла содержит три натуральных числа n, m и k — количество городов в мире, количество рейсов и количество лекций, которые он должен дать, соответственно (n ≤ 100, m ≤ 104, 2 ≤ k ≤ 104). Города пронумерованы числами от 1 до n.

Следующие m строк содержат описание рейсов, по одному на строке. Рейс номер i описывается тремя числами bi, ei и wi — номер начального и конечного города рейса и предполагаемое изменение веса А. в миллиграммах (1 ≤ bi, ei ≤ n, −105 ≤ wi ≤ 105).

Последняя строка содержит числа a1, a2, …, ak — номера городов, в которых проводятся лекции. В начале тура он находится в городе a1.

Гарантируется, что он может прочесть все лекции.

Формат вывода
Первая строка выходного файла должна содержать число s — количество рейсов, которые он должен сделать. Вторая строка должна содержать s чисел — номера используемых рейсов. Если существует такая последовательность маршрутов между концертами, что А. будет набирать вес неограниченно, то первая строка выходного файла должна содержать строку infinitely kind. 

Примечания
Тут не использовалась ChatGPT. 
